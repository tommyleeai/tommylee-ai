# ğŸ”® Magic Modal çµ±ä¸€è¨­è¨ˆè¦ç¯„ v1.1

> æœ¬æ–‡ä»¶æ•´ç†è‡ªæ‰€æœ‰ç¾æœ‰ Magic Modalï¼ˆç¨®æ—/è·æ¥­/è¡¨æƒ…/å§¿å‹¢/æœè£/é ­é£¾/æ‰‹æŒç‰©/é«®å‹/èº«æ/å ´æ™¯/å‹•æ¼«é¢¨æ ¼/è—è¡“é¢¨æ ¼/è—è¡“å®¶ï¼‰çš„è¨­è¨ˆæ¨¡å¼ï¼Œ
> ä½œç‚ºå¾ŒçºŒæ–°å¢ Tab å…§ section çš„æ¨™æº–åƒè€ƒã€‚

---

## ä¸€ã€ä¸‰å¤§æ¶æ§‹æ¨¡å¼

ç›®å‰æ‰€æœ‰ Magic Modal å¯æ­¸é¡ç‚º **ä¸‰ç¨®ä¸»æ¶æ§‹**ï¼Œæ–°åŠŸèƒ½æ‡‰å¾ä¸­é¸æ“‡æœ€é©åˆçš„æ¨¡å¼ï¼š

### A å‹ï¼šåˆ†é¡ Grid + Bonus Traitsï¼ˆé¸ä¸€å€‹ + å¯é¸åŠ åˆ†ç‰¹å¾µï¼‰

| ä»£è¡¨ | æª”æ¡ˆ | CSS å‰ç¶´ |
|------|------|---------|
| ç¨®æ— | `race-magic-modal.js` | `rmm-` |
| è·æ¥­ | `job-magic-modal.js` | `jmm-` |
| æœè£ | `outfit-magic-modal.js` | `cmm-` |
| é ­é£¾ | `headwear-magic-modal.js` | `hwmm-` |
| æ‰‹æŒç‰© | `hand-items-magic-modal.js` | `himm-` |

**çµæ§‹**ï¼š
```
Headerï¼ˆæ¨™é¡Œ + éª°å­éš¨æ©Ÿ + æœå°‹ï¼‰
 â”œâ”€â”€ åˆ†é¡ Tabsï¼ˆå…¨éƒ¨/æœ€è¿‘/ç†±é–€/åˆ†é¡1/åˆ†é¡2...ï¼‰
 â”œâ”€â”€ Gridï¼ˆ4æ¬„ chipï¼Œicon + ä¸­æ–‡ + è‹±æ–‡ï¼‰
 â”œâ”€â”€ A-Z ç´¢å¼•ï¼ˆå³å´å‚ç›´ï¼‰
 â”œâ”€â”€ Bonus Panelï¼ˆé¸é …å¾Œå‡ºç¾çš„åŠ åˆ†ç‰¹å¾µé‡‘è‰² tagï¼‰
 â””â”€â”€ Footerï¼ˆç‹€æ…‹æ–‡å­— + å–æ¶ˆ/å¥—ç”¨æŒ‰éˆ•ï¼‰
```

**ç‰¹é»**ï¼š
- æœ‰ ğŸ² éª°å­éš¨æ©Ÿé¸å–ï¼ˆå«å‹•ç•« + éŸ³æ•ˆï¼‰
- æœ‰æœ€è¿‘ä½¿ç”¨è¨˜éŒ„ï¼ˆlocalStorage æœ€å¤š 10 ç­†ï¼‰
- æœ‰ç†±é–€ Top 20ï¼ˆğŸ”¥ badgeï¼‰
- é¸ä¸­å¾Œå¯é™„åŠ  Bonus Traitsï¼ˆåŠ åˆ†ç‰¹å¾µï¼‰
- é¸é …æ”¯æ´ **toggle**ï¼šå†é»ä¸€æ¬¡å–æ¶ˆ

---

### B å‹ï¼šGrid + æ¨æ¡¿æ§åˆ¶ + ç‰¹æ•ˆå‹¾é¸

| ä»£è¡¨ | æª”æ¡ˆ | CSS å‰ç¶´ |
|------|------|---------|
| è¡¨æƒ… | `expression-magic-modal.js` | `emm-` |
| å§¿å‹¢ | `pose-magic-modal.js` | `pmm-` |

**çµæ§‹**ï¼š
```
Headerï¼ˆæ¨™é¡Œ + é‡è¨­ï¼‰
 â”œâ”€â”€ åˆ†é¡ Tabsï¼ˆåˆ†é¡ icon + æ–‡å­—ï¼‰
 â”œâ”€â”€ æœå°‹ bar
 â”œâ”€â”€ Gridï¼ˆ2-3æ¬„ chipï¼Œä¸­æ–‡ + è‹±æ–‡ï¼‰
 â”œâ”€â”€ æ§åˆ¶å€ï¼ˆæ¨æ¡¿/é‡å¿ƒ/è¦–ç·š/ç‰¹æ•ˆå‹¾é¸ï¼‰
 â”œâ”€â”€ é è¦½å€ï¼ˆå³æ™‚ prompt é è¦½ï¼‰
 â””â”€â”€ Footerï¼ˆç‹€æ…‹æ–‡å­— + å–æ¶ˆ/å¥—ç”¨æŒ‰éˆ•ï¼‰
```

**B å‹è®Šé«”å·®ç•°**ï¼š

| å·®ç•°é» | è¡¨æƒ… Modal | å§¿å‹¢ Modal |
|--------|-----------|-----------|
| æ§åˆ¶å€ | å¼·åº¦æ¨æ¡¿ï¼ˆ7ç´šï¼‰+ 8å€‹ç‰¹æ•ˆå‹¾é¸ | é‡å¿ƒä½ç½® chip + è¦–ç·šæ–¹å‘ chip |
| ç‰¹æ•ˆ | `Set<effectId>`ï¼Œå¤šé¸ | é‡å¿ƒå’Œè¦–ç·šå„ **å–®é¸ï¼ˆå¯ç‚ºç©ºï¼‰** |
| é è¦½ | prompt æ–‡å­— + æ¬Šé‡æŒ‡ç¤ºå™¨ | prompt tag |

---

### C å‹ï¼šç´”æ¨æ¡¿æ§åˆ¶

| ä»£è¡¨ | æª”æ¡ˆ | CSS å‰ç¶´ |
|------|------|---------|
| é«®å‹ | `hair-magic-modal.js` | `hmm-` |
| èº«æ | `body-magic-modal.js` | `bmm-` |

**çµæ§‹**ï¼š
```
Headerï¼ˆæ¨™é¡Œï¼‰
 â”œâ”€â”€ åˆ†é¡ Tabs / é è¨­æŒ‰éˆ•
 â”œâ”€â”€ Gridï¼ˆchip é¸æ“‡ï¼‰ + æ¨æ¡¿æ§åˆ¶ï¼ˆé•·åº¦/é«˜åº¦/æ•¸é‡/éƒ¨ä½...ï¼‰
 â”œâ”€â”€ å¹»æƒ³æ©«å¹…ï¼ˆæ¨æ¡¿è¶…éé–¾å€¼æ™‚å‡ºç¾ï¼‰
 â””â”€â”€ Footerï¼ˆå–æ¶ˆ/å¥—ç”¨æŒ‰éˆ•ï¼‰
```

---

## äºŒã€çµ±ä¸€ UI å…ƒä»¶è¦ç¯„

### 2.1 é¸é … Chip

æ‰€æœ‰ Modal å…±ç”¨åŒä¸€è¨­è¨ˆèªè¨€çš„ chipï¼š

```css
/* æ­£å¸¸æ…‹ */
background: rgba(30, 41, 59, 0.4~0.6);
border: 1px solid rgba(148, 163, 184, 0.1);
border-radius: 8px;
color: #e2e8f0;

/* Hover */
border-color: rgba(168, 85, 247, 0.5);
transform: translateY(-1px);
color: #c084fc;

/* Selected / Active */
background: linear-gradient(135deg, rgba(124,58,237,0.3), rgba(168,85,247,0.2));
border-color: #a855f7;
color: #fff;
box-shadow: 0 0 10px rgba(168,85,247,0.3);
```

**äº’å‹•è¦å‰‡**ï¼š
- âœ… é»é¸ = é¸å–ï¼ˆç™¼å…‰ï¼‰
- âœ… å†é»åŒä¸€å€‹ = **å–æ¶ˆé¸å–**ï¼ˆtoggle offï¼‰
- âœ… é»å¦ä¸€å€‹ = åˆ‡æ›åˆ°æ–°é¸é …

### 2.2 åˆ†é¡ Tabs

```css
/* Tab ä¸‰æ…‹åŒ magic-modal-style.md å®šç¾© */
æ­£å¸¸: background rgba(30,41,59,.4), color #94a3b8
Hover: color #c084fc, translateY(-2px), border-bottom ç´«
Active: gradient èƒŒæ™¯, color #f3e8ff, border-bottom 3px #a855f7
```

**Tab çµ±ä¸€å››å±¤çµæ§‹**ï¼ˆv1.1 èµ·æ‰€æœ‰ Modal å¿…é ˆä½¿ç”¨ï¼‰ï¼š
```html
<button class="xxx-tab">
    <span class="xxx-tab-icon">ğŸ­</span>     <!-- ç¬¬ 1 å±¤ï¼šEmoji icon -->
    <span class="xxx-tab-zh">åˆ†é¡å</span>    <!-- ç¬¬ 2 å±¤ï¼šä¸­æ–‡æ¨™ç±¤ -->
    <span class="xxx-tab-en">English</span>   <!-- ç¬¬ 3 å±¤ï¼šè‹±æ–‡æ¨™ç±¤ -->
    <span class="xxx-tab-count">12</span>     <!-- ç¬¬ 4 å±¤ï¼šé …ç›®æ•¸é‡ -->
</button>
```

**Tab å››å±¤ CSS çµ±ä¸€æ¨£å¼**ï¼š
```css
.xxx-tab-icon   { font-size: .95rem; transition: transform .25s ease, filter .25s ease }
.xxx-tab-zh     { font-size: .65rem; font-weight: 500 }
.xxx-tab-en     { font-size: .55rem; color: #64748b }
.xxx-tab-count  { font-size: .55rem; color: #64748b; transition: color .25s ease }
/* Active ç‹€æ…‹ */
.xxx-tab.active .xxx-tab-icon  { transform: scale(1.15); filter: drop-shadow(0 0 6px rgba(ä¸»é¡Œè‰², .6)) }
.xxx-tab.active .xxx-tab-count { color: ä¸»é¡Œæ·ºè‰²; font-weight: 600 }
```

### 2.3 æœå°‹ Bar

```css
width: 100%;
padding: 8px 12px;
background: rgba(255,255,255,0.06);
border: 1px solid rgba(255,255,255,0.12);
border-radius: 8px;
color: #e2e8f0;
font-size: 13px;
/* focus æ™‚ border-color è®Šç‚ºä¸»é¡Œè‰² */
```

- æ”¯æ´**ä¸­æ–‡ + è‹±æ–‡**å³æ™‚éæ¿¾
- éæ¿¾é‚è¼¯ï¼š`label.includes(query) || en.toLowerCase().includes(query)`

### 2.4 æ§åˆ¶å€ Chipï¼ˆé‡å¿ƒ/è¦–ç·š/ç‰¹æ•ˆç­‰é™„åŠ é¸é …ï¼‰

```css
/* æ­£å¸¸æ…‹ */
background: rgba(30, 41, 59, 0.5);
border: 1px solid rgba(255, 255, 255, 0.1);
border-radius: 20px;
padding: 6px 14px;
color: #94a3b8;

/* Activeï¼ˆé¸ä¸­æ™‚ï¼‰ */
background: rgba(168, 85, 247, 0.25);
border-color: #a855f7;
color: #e2e8f0;
box-shadow: 0 0 8px rgba(168, 85, 247, 0.3);
```

**äº’å‹•è¦å‰‡**ï¼š
- é è¨­ç‚º **ä¸é¸æ“‡**ï¼ˆnullï¼‰ï¼Œä¸æ˜¯é é¸æŸå€‹å€¼
- é»æ“Š = é¸å–ï¼Œå†é»åŒä¸€å€‹ = å–æ¶ˆï¼ˆå›åˆ° nullï¼‰
- ç”¨æ–¼ã€Œå¯é¸å¯ä¸é¸ã€çš„è¼”åŠ©æ§åˆ¶

### 2.5 Footer

```html
<div class="xxx-footer">
    <div class="xxx-status">å·²é¸ï¼š**é …ç›®å**</div>
    <div class="xxx-actions">
        <button class="xxx-btn xxx-btn-cancel">âŒ å–æ¶ˆ</button>
        <button class="xxx-btn xxx-btn-apply">âœ¨ å¥—ç”¨é­”æ³•</button>
    </div>
</div>
```

---

## ä¸‰ã€ç‹€æ…‹ç®¡ç†è¦ç¯„

### 3.1 State å„²å­˜æ ¼å¼

æ‰€æœ‰ Modal çš„é€²éšç‹€æ…‹éƒ½çµ±ä¸€å­˜åœ¨ `state.{category}Advanced`ï¼š

| Modal | State Key | å…§å®¹ |
|-------|-----------|------|
| ç¨®æ— | `state.raceAdvanced` | `{ selectedRace, bonusTraits[], bonusTraitsZh[] }` |
| è·æ¥­ | `state.jobAdvanced` | `{ selectedJob, bonusTraits[], bonusTraitsZh[] }` |
| æœè£ | `state.outfitAdvanced` | `{ selectedOutfit, bonusTraits[], bonusTraitsZh[] }` |
| é ­é£¾ | `state.headwearAdvanced` | `{ selectedHeadwear, bonusTraits[], bonusTraitsZh[] }` |
| æ‰‹æŒç‰© | `state.handItemsAdvanced` | `{ selectedHandItem, bonusTraits[], bonusTraitsZh[] }` |
| è¡¨æƒ… | `state.expressionAdvanced` | `{ expression, intensity, effects[] }` |
| å§¿å‹¢ | `state.poseAdvanced` | `{ pose, gravity, gaze }` |
| é«®å‹ | `state.hairAdvanced` | `{ style, length, ponytail, ... }` |
| èº«æ | `state.bodyAdvanced` | `{ bodyType, params{} }` |

### 3.2 localStorage æŒä¹…åŒ–

åœ¨ `loadState()` ä¸­è®€å–ã€åœ¨ `saveState()` ä¸­å¯«å…¥ã€‚
**æ³¨æ„**ï¼šæ‰€æœ‰ `xxxAdvanced` éƒ½å¿…é ˆåœ¨ `loadState()` ä¸­æœ‰å°æ‡‰çš„è®€å–è¡Œï¼Œå¦å‰‡é é¢é‡è¼‰å¾Œæ©«å¹…æœƒæ¶ˆå¤±ã€‚

```javascript
// loadState() ç¯„ä¾‹
state.expressionAdvanced = parsed.expressionAdvanced || undefined;
state.poseAdvanced = parsed.poseAdvanced || undefined;
// âš  åƒè¬ä¸èƒ½æ¼æ‰ï¼Œå¦å‰‡é‡è¼‰å¾Œ banner æ¶ˆå¤±
```

### 3.3 æ¸…é™¤é‚è¼¯

```javascript
// æ¸…é™¤æŒ‰éˆ•
delete state.xxxAdvanced;
renderTabContent();
generatePrompt();
saveState();
```

---

## å››ã€ç´«è‰²æ©«å¹…ï¼ˆBannerï¼‰è¦ç¯„

ç•¶ Magic å•Ÿç”¨æ™‚ï¼Œåœ¨åŸºç¤ grid ä¸Šæ–¹é¡¯ç¤ºç´«è‰²æ‘˜è¦æ©«å¹…ï¼š

### 4.1 HTML çµæ§‹

```javascript
const summaryBar = document.createElement('div');
summaryBar.className = 'body-advanced-summary';  // â† çµ±ä¸€ class

const summaryText = document.createElement('span');
summaryText.innerHTML = `ğŸ”® XXXé­”æ³•å•Ÿç”¨ä¸­ï¼š${detailText}`;

const editBtn = document.createElement('button');
editBtn.className = 'body-summary-action';       // â† çµ±ä¸€ class
editBtn.textContent = 'ç·¨è¼¯';

const clearBtn = document.createElement('button');
clearBtn.className = 'body-summary-action clear'; // â† çµ±ä¸€ class
clearBtn.textContent = 'æ¸…é™¤';
```

### 4.2 æ©«å¹…æ–‡å­—æ ¼å¼

| Modal | æ©«å¹…æ ¼å¼ |
|-------|---------|
| ç¨®æ—/è·æ¥­ | `ğŸ”® ç¨®æ—é­”æ³•å•Ÿç”¨ä¸­ï¼šç²¾éˆ Elf â€” â­ å°–è€³æœµã€âœ¨ ç™¼å…‰` |
| è¡¨æƒ… | `ğŸ”® è¡¨æƒ…é­”æ³•å•Ÿç”¨ä¸­ï¼šé–‹æ‡·å¤§ç¬‘ (æ¨™æº–) â€” ğŸ’§ æ·šæ°´ã€ğŸ˜° æ±—ç ` |
| å§¿å‹¢ | `ğŸ”® å§¿å‹¢é­”æ³•å•Ÿç”¨ä¸­ï¼šå‰è…°ç«™ç«‹ âš–ï¸ å¾Œä»° ğŸ‘ï¸ æ–œè¦–` |
| æœè£/é ­é£¾/æ‰‹æŒç‰© | `ğŸ”® æœè£é­”æ³•å•Ÿç”¨ä¸­ï¼šæ——è¢ â€” â­ ç‰¹å¾µ1ã€ç‰¹å¾µ2` |

**è¦å‰‡**ï¼š
- åˆ—å‡º**å…·é«”åç¨±**ï¼Œä¸ç”¨ `+Nç‰¹æ•ˆ` é€™ç¨®æ•¸é‡æ‘˜è¦
- ç”¨ `â€”`ï¼ˆem dashï¼‰åˆ†éš”ä¸»é …ç›®å’Œé™„åŠ ç‰¹å¾µ
- ç”¨ `ã€`ï¼ˆé “è™Ÿï¼‰åˆ†éš”å¤šå€‹ç‰¹å¾µ

### 4.3 Grid ç°åŒ–

Magic æ©«å¹…å•Ÿç”¨æ™‚ï¼Œåº•ä¸‹çš„åŸºç¤ grid åŠ ä¸Š disabled æ•ˆæœï¼š

```javascript
const tagGrid = sectionEl.querySelector('.tag-grid-paginated');
if (tagGrid) tagGrid.classList.add('body-section-disabled');
```

```css
.body-section-disabled {
    pointer-events: none;
    opacity: 0.35;
    filter: grayscale(0.3);
}
```

---

## äº”ã€è‰²å½©ç³»çµ±

### ä¸»è‰²ï¼ˆç´«è‰²ç³» â€” å…¨åŸŸé­”æ³•ä¸»é¡Œè‰²ï¼‰
| è‰²ç¢¼ | ç”¨é€” |
|------|------|
| `#a855f7` | ä¸»è‰²ï¼šé¸ä¸­é‚Šæ¡†ã€active åº•ç·šã€banner |
| `#7c3aed` | æ·±ä¸»è‰²ï¼šæ¼¸å±¤èµ·é»ã€æŒ‰éˆ• |
| `#c084fc` | æ·ºä¸»è‰²ï¼šhover æ–‡å­— |
| `#f3e8ff` | è¶…æ·ºï¼šactive tab æ–‡å­— |

### å¼·èª¿è‰²
| è‰²ç¢¼ | ç”¨é€” |
|------|------|
| `#fbbf24` | é‡‘è‰²ï¼šBonus Traitsã€ç†±é–€ |
| `#38bdf8` | è—è‰²ï¼šæœ€è¿‘ä½¿ç”¨ |
| `#22d3ee` | é’è‰²ï¼šå§¿å‹¢ Modal ä¸»é¡Œè‰² |

### æ·±è‰²ä¸»é¡ŒèƒŒæ™¯
| å…ƒç´  | è‰²å€¼ |
|------|------|
| å®¹å™¨èƒŒæ™¯ | `linear-gradient(135deg, rgba(15,23,42,.97), rgba(30,41,59,.97))` |
| å…ƒä»¶èƒŒæ™¯ | `rgba(30, 41, 59, .4~.6)` |
| é®ç½© | `rgba(0, 0, 0, .6)` |
| é‚Šæ¡† | `rgba(148, 163, 184, .1~.15)` |

### 5.4 å…¨ç«™é¡è‰²ç­‰ç´šç³»çµ±ï¼ˆColor Tier Systemï¼‰

> [!IMPORTANT]
> é¡è‰²ç­‰ç´šä»£è¡¨ç¨€æœ‰åº¦/é‡è¦åº¦ï¼Œæ‰€æœ‰ UI å…ƒç´ å¿…é ˆéµå¾ªæ­¤è¦å‰‡ã€‚ç¦æ­¢ç”¨é«˜ç­‰ç´šé¡è‰²æ¨™ç¤ºä½é‡è¦åº¦å…ƒç´ ã€‚

| ç­‰ç´š | é¡è‰² | ç”¨é€” |
|------|------|------|
| â˜…â˜†â˜†â˜†â˜†â˜† | **æ·ºç°è‰²** `#94a3b8` | æœªé¸ä¸­é¸é …ã€æ¬¡è¦æ–‡å­—ã€disabled ç‹€æ…‹ |
| â˜…â˜…â˜†â˜†â˜†â˜† | **ç™½è‰²** `#e2e8f0` | å·²é¸ä¸­çš„åŸºç¤é¸é …ã€æ­£å¸¸æ–‡å­— |
| â˜…â˜…â˜…â˜†â˜†â˜† | **ç´«è‰²** `#a855f7` | é€²éšåŠŸèƒ½ã€Active ç‹€æ…‹ã€é­”æ³•ä¸»é¡Œ |
| â˜…â˜…â˜…â˜…â˜†â˜† | **é‡‘è‰²** `#fbbf24` | é«˜ç´š/ç¨€æœ‰é …ç›®ï¼ˆå¦‚é«˜ç´šé­”æ³•å¸«æŒ‰éˆ•ã€Bonus Traitsï¼‰ |
| â˜…â˜…â˜…â˜…â˜…â˜† | **é‡‘è‰²æµè½‰å‹•ç•«** | å‚³èªªç´šé …ç›®ï¼ˆ`@keyframes` é‡‘è‰²æ¼¸å±¤ä½ç§»ï¼‰ |
| â˜…â˜…â˜…â˜…â˜…â˜… | **å½©è‰²æµè½‰å‹•ç•«** | ç¥è©±ç´šé …ç›®ï¼ˆ`@keyframes` å½©è™¹æ¼¸å±¤ä½ç§»ï¼‰ |

---

## å…­ã€å‹•ç•«è¦ç¯„

### é€šç”¨ Transition
```css
transition: all 0.2s ease;
```

### Modal å…¥å ´
- Overlay: `fadeIn 0.3s`
- Container: `scale(0.5â†’1)` + `cubic-bezier(.34, 1.56, .64, 1)` 0.5s
- æ¨™é¡Œ: `blur(8pxâ†’0)` å»¶é² 0.3s

### äº’å‹•å›é¥‹
- Hover: `translateY(-1px~-2px)` + é‚Šæ¡†é«˜äº®
- é»é¸: ç´«è‰² border + box-shadow
- é—œé–‰: åå‘ `fadeIn 0.3s reverse`

### ç²’å­èƒŒæ™¯
- æµ®å‹•å…‰é»ï¼š25-40 å€‹ï¼Œéš¨æ©Ÿä½ç½®/å¤§å°/å»¶é²/è‰²å½©
- æµæ˜Ÿï¼ˆA å‹ Modal å°ˆå±¬ï¼‰ï¼š3-4 æ¢ï¼Œæ–œå‘åŠƒé

---

## ä¸ƒã€éŸ³æ•ˆè¦ç¯„

| äº‹ä»¶ | éŸ³æ•ˆé¡å‹ | å¯¦ä½œæ–¹å¼ |
|------|---------|---------|
| Modal é–‹å•Ÿ | ä¸Šå‡ç¶éŸ³ | Web Audio API oscillator |
| é¸é …é»æ“Š | æ¸…è„†å®è² | `sfx.playClick()` |
| å¥—ç”¨é­”æ³• | æ–½æ³•éŸ³æ•ˆï¼ˆä¸Šå‡ç¶éŸ³ + æ˜Ÿå…‰ï¼‰ | è‡ªå®šç¾© oscillator åºåˆ— |
| éª°å­æ»¾å‹• | ä½é »éš†éš† + ç¢°æ’ | sawtooth + square burst |

---

## å…«ã€æ¨¡çµ„åŒ–çµæ§‹

### æª”æ¡ˆå‘½å
```
modules/{feature}-magic-modal.js  â† JS é‚è¼¯
data/{feature}-magic-data.js      â† è³‡æ–™å®šç¾©
styles/{feature}-magic-modal.css  â† CSS æ¨£å¼
```

### IIFE æ¨¡çµ„æ¨¡æ¿
```javascript
window.PromptGen = window.PromptGen || {};
window.PromptGen.{Feature}MagicModal = (function () {
    let state, sfx, DATA, generatePrompt, saveState, renderTabContent;

    function setup(deps) {
        state = deps.state;
        sfx = deps.sfx;
        DATA = deps.DATA;
        generatePrompt = deps.generatePrompt;
        saveState = deps.saveState;
        renderTabContent = deps.renderTabContent;
    }

    function open{Feature}MagicModal() {
        // 1. ç§»é™¤èˆŠ modal
        // 2. è®€å– saved state
        // 3. å»ºç«‹ overlay DOM
        // 4. ç²’å­æ•ˆæœ + éŸ³æ•ˆ
        // 5. æ¸²æŸ“ grid
        // 6. ç¶å®šäº‹ä»¶ï¼ˆtab/æœå°‹/é¸æ“‡/æ§åˆ¶/å¥—ç”¨/å–æ¶ˆ/ESC/å¤–éƒ¨é»æ“Šï¼‰
    }

    return { setup, open{Feature}MagicModal };
})();
```

### è³‡æ–™å®šç¾©æ¨¡æ¿
```javascript
window.PromptGen = window.PromptGen || {};
window.PromptGen.{Feature}MagicData = {
    TABS: [
        { id: 'all', icon: 'ğŸŒ', label: 'å…¨éƒ¨', en: 'All' },
        { id: 'recent', icon: 'ğŸ“‹', label: 'æœ€è¿‘', en: 'Recent' },
        { id: 'hot', icon: 'ğŸ”¥', label: 'ç†±é–€', en: 'Hot' },
        { id: 'cat1', icon: 'ğŸ¨', label: 'åˆ†é¡1', en: 'Category1' },
        // ...
    ],
    ITEMS: [
        { id: 'item1', label: 'ä¸­æ–‡å', en: 'English', value: 'prompt_value', category: 'cat1' },
        // ...
    ],
    // A å‹ç‰¹æœ‰ï¼š
    CATEGORIES: [...],
    HOT_ITEMS: [...],
    BONUS_TRAITS: { cat1: [{icon, zh, en}], ... },
    // B å‹ç‰¹æœ‰ï¼š
    INTENSITY: [...],    // å¼·åº¦ç­‰ç´š
    EFFECTS: [...],      // ç‰¹æ•ˆé¸é …
    GRAVITY: [...],      // æ§åˆ¶é¸é …
    GAZE: [...],         // æ§åˆ¶é¸é …
};
```

---

## ä¹ã€CSS å‰ç¶´å‘½åè¦ç¯„

| Modal | å‰ç¶´ | èªªæ˜ |
|-------|------|------|
| ç¨®æ— | `rmm-` | Race Magic Modal |
| è·æ¥­ | `jmm-` | Job Magic Modal |
| æœè£ | `cmm-` | Costume Magic Modal |
| é ­é£¾ | `hmm-` | Headwear Magic Modal |
| æ‰‹æŒç‰© | `him-` | Hand Items Magic Modal |
| è¡¨æƒ… | `emm-` | Expression Magic Modal |
| å§¿å‹¢ | `pmm-` | Pose Magic Modal |
| é«®å‹ | `hmm-` | Hair Magic Modal |
| èº«æ | `bmm-` | Body Magic Modal |
| å ´æ™¯ | `scmm-` | Scene Magic Modal |
| å‹•æ¼«/è—è¡“/è—è¡“å®¶ | `smm-` | Style Magic Modalï¼ˆä¸‰è€…å…±ç”¨ï¼‰ |

---

## åã€æ–°å»º Section çš„ Checklist

1. â˜ æ±ºå®šä½¿ç”¨ **A / B / C å‹**æ¶æ§‹
2. â˜ å»ºç«‹ `data/{feature}-magic-data.js`ï¼ˆå®šç¾© TABSã€ITEMS ç­‰ï¼‰
3. â˜ å»ºç«‹ `modules/{feature}-magic-modal.js`ï¼ˆIIFE æ¨¡çµ„ï¼‰
4. â˜ å»ºç«‹ `styles/{feature}-magic-modal.css`ï¼ˆè¤‡è£½æ¨¡æ¿ + æ›å‰ç¶´ï¼‰
5. â˜ åœ¨ `index.html` åŠ å…¥ CSS `<link>` å’Œ JS `<script>`ï¼ˆå« `?v=x.x`ï¼‰
6. â˜ åœ¨ `script.js` ä¸­ï¼š
   - `setup()` æ³¨å…¥ä¾è³´
   - æ¸²æŸ“ section æ™‚åŠ å…¥ã€Œé«˜ç´šé­”æ³•ã€æŒ‰éˆ•
   - æ©«å¹…é‚è¼¯ï¼ˆ`body-advanced-summary`ï¼‰
   - Grid ç°åŒ–é‚è¼¯ï¼ˆ`body-section-disabled`ï¼‰
   - `loadState()` è®€å– `state.xxxAdvanced`
   - `saveState()` å¯«å…¥ `state.xxxAdvanced`
   - `generatePrompt()` åŠ å…¥ prompt é‚è¼¯
7. â˜ æ¸¬è©¦ï¼šæœå°‹ã€Tab åˆ‡æ›ã€é¸å– toggleã€å¥—ç”¨ã€æ¸…é™¤ã€é‡è¼‰æŒä¹…åŒ–
8. â˜ CSS ä¿®æ”¹ç”¨ `/* === åŠŸèƒ½å START === */` åŒ…è£¹
9. â˜ åŸ·è¡Œ `/version-bump`
