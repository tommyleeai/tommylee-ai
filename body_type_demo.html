<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èº«ææ§åˆ¶ç³»çµ± Demo v2</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: #0a0e1a;
            color: #e2e8f0;
            min-height: 100vh;
            padding: 30px;
        }

        h1 {
            text-align: center;
            font-size: 1.6rem;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #a78bfa, #60a5fa);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            text-align: center;
            font-size: 0.85rem;
            color: #64748b;
            margin-bottom: 30px;
        }

        .layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .panel {
            background: rgba(30, 41, 59, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(148, 163, 184, 0.15);
            border-radius: 16px;
            padding: 24px;
        }

        .panel h2 {
            font-size: 1.1rem;
            margin-bottom: 20px;
            color: #a78bfa;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* === Gender Toggle === */
        .gender-toggle {
            display: flex;
            gap: 10px;
            margin-bottom: 24px;
        }

        .gender-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid transparent;
            border-radius: 10px;
            background: rgba(51, 65, 85, 0.6);
            color: #94a3b8;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .gender-btn.active {
            border-color: #a78bfa;
            color: #e2e8f0;
            background: rgba(167, 139, 250, 0.15);
        }

        .gender-btn:hover {
            background: rgba(167, 139, 250, 0.1);
        }

        /* === Body Feature Slider === */
        .feature-group {
            margin-bottom: 28px;
        }

        .feature-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .feature-label {
            font-size: 0.95rem;
            font-weight: 600;
        }

        .feature-value {
            font-size: 0.8rem;
            color: #a78bfa;
            padding: 3px 12px;
            background: rgba(167, 139, 250, 0.15);
            border-radius: 20px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .feature-value.fantasy {
            color: #fbbf24;
            background: rgba(251, 191, 36, 0.2);
            border: 1px solid rgba(251, 191, 36, 0.3);
            animation: fantasy-glow 2s ease-in-out infinite;
        }

        @keyframes fantasy-glow {

            0%,
            100% {
                box-shadow: 0 0 5px rgba(251, 191, 36, 0.2);
            }

            50% {
                box-shadow: 0 0 15px rgba(251, 191, 36, 0.4);
            }
        }

        /* Slider scale labels */
        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.65rem;
            color: #64748b;
            position: relative;
        }

        .scale-labels span {
            text-align: center;
            flex: 1;
        }

        .scale-labels .fantasy-label {
            color: #fbbf24;
            font-weight: 600;
            font-size: 0.6rem;
        }

        /* Fantasy zone indicator */
        .slider-wrapper {
            position: relative;
        }

        .fantasy-zone {
            position: absolute;
            top: -2px;
            height: 12px;
            border-radius: 4px;
            pointer-events: none;
            z-index: 0;
        }

        .fantasy-zone-left {
            left: 0;
            width: 14.28%;
            background: repeating-linear-gradient(45deg, rgba(251, 191, 36, 0.1), rgba(251, 191, 36, 0.1) 3px, transparent 3px, transparent 6px);
            border: 1px dashed rgba(251, 191, 36, 0.3);
            border-right: none;
            border-radius: 4px 0 0 4px;
        }

        .fantasy-zone-right {
            right: 0;
            width: 14.28%;
            background: repeating-linear-gradient(45deg, rgba(251, 191, 36, 0.1), rgba(251, 191, 36, 0.1) 3px, transparent 3px, transparent 6px);
            border: 1px dashed rgba(251, 191, 36, 0.3);
            border-left: none;
            border-radius: 0 4px 4px 0;
        }

        /* Custom range slider */
        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            border-radius: 4px;
            outline: none;
            cursor: pointer;
            position: relative;
            z-index: 1;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: linear-gradient(135deg, #a78bfa, #7c3aed);
            box-shadow: 0 0 10px rgba(167, 139, 250, 0.5);
            cursor: pointer;
            margin-top: -7px;
            transition: box-shadow 0.3s;
        }

        input[type="range"].in-fantasy::-webkit-slider-thumb {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.6);
        }

        input[type="range"]::-webkit-slider-runnable-track {
            height: 8px;
            border-radius: 4px;
        }

        /* Slider gradient colors */
        .slider-bust {
            background: linear-gradient(to right, #3b82f6, #60a5fa, #a78bfa, #f472b6, #ef4444);
        }

        .slider-muscle {
            background: linear-gradient(to right, #3b82f6, #94a3b8, #60a5fa, #a78bfa, #f97316, #ef4444);
        }

        .slider-height {
            background: linear-gradient(to right, #3b82f6, #f9a8d4, #94a3b8, #60a5fa, #a78bfa, #ef4444);
        }

        .slider-weight {
            background: linear-gradient(to right, #3b82f6, #60a5fa, #94a3b8, #a78bfa, #f97316, #ef4444);
        }

        /* === Output Box === */
        .output-box {
            margin-bottom: 16px;
        }

        .output-label {
            font-size: 0.75rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 6px;
        }

        .output-text {
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 10px;
            padding: 14px;
            font-size: 0.85rem;
            line-height: 1.6;
            color: #cbd5e1;
            min-height: 60px;
            word-wrap: break-word;
            white-space: pre-wrap;
        }

        .output-text .positive {
            color: #86efac;
        }

        .output-text .negative {
            color: #fca5a5;
        }

        .output-text .weight {
            color: #fcd34d;
        }

        .output-text .tag {
            color: #93c5fd;
        }

        .output-text .fantasy-tag {
            color: #fbbf24;
            font-weight: 600;
        }

        /* Weight indicator */
        .weight-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            font-size: 0.78rem;
        }

        .weight-bar {
            flex: 1;
            height: 6px;
            background: rgba(51, 65, 85, 0.5);
            border-radius: 3px;
            overflow: hidden;
        }

        .weight-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s, background 0.3s;
        }

        .weight-num {
            font-weight: 600;
            min-width: 30px;
            text-align: right;
        }

        /* Fantasy warning banner */
        .fantasy-banner {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.15), rgba(245, 158, 11, 0.1));
            border: 1px solid rgba(251, 191, 36, 0.3);
            border-radius: 10px;
            padding: 10px 14px;
            margin-bottom: 16px;
            font-size: 0.78rem;
            color: #fbbf24;
            display: none;
            align-items: center;
            gap: 8px;
            animation: fadeIn 0.3s ease;
        }

        .fantasy-banner.show {
            display: flex;
        }

        .fantasy-banner .icon {
            font-size: 1.2rem;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Explanation panel */
        .explanation {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(148, 163, 184, 0.1);
            border-radius: 10px;
            padding: 14px;
            margin-top: 16px;
            font-size: 0.78rem;
            line-height: 1.6;
            color: #94a3b8;
        }

        .explanation strong {
            color: #e2e8f0;
        }

        /* Quick presets */
        .presets {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 12px;
        }

        .preset-btn {
            padding: 6px 12px;
            border: 1px solid rgba(148, 163, 184, 0.2);
            border-radius: 8px;
            background: rgba(51, 65, 85, 0.4);
            color: #94a3b8;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .preset-btn:hover {
            border-color: #a78bfa;
            color: #e2e8f0;
            background: rgba(167, 139, 250, 0.15);
        }

        .preset-btn.fantasy-preset {
            border-color: rgba(251, 191, 36, 0.3);
            color: #fbbf24;
        }

        .preset-btn.fantasy-preset:hover {
            border-color: #fbbf24;
            background: rgba(251, 191, 36, 0.15);
        }

        .preset-divider {
            width: 100%;
            height: 1px;
            background: rgba(148, 163, 184, 0.1);
            margin: 4px 0;
        }

        .preset-section-label {
            width: 100%;
            font-size: 0.65rem;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
    </style>
</head>

<body>

    <h1>ğŸ›ï¸ èº«ææ§åˆ¶ç³»çµ± Demo v2 â€” å«å¹»æƒ³ç´šåˆ¥</h1>
    <p class="subtitle">Body Type Weight System â€” ç¾å¯¦ â†” å¹»æƒ³ç´šåˆ¥ 7 æ®µæ»‘æ¡¿</p>

    <div class="layout">
        <!-- Left: Controls -->
        <div class="panel">
            <h2>âš™ï¸ æ§åˆ¶é¢æ¿</h2>

            <!-- Gender -->
            <div class="gender-toggle">
                <button class="gender-btn active" onclick="setGender('female')">â™€ å¥³æ€§</button>
                <button class="gender-btn" onclick="setGender('male')">â™‚ ç”·æ€§</button>
            </div>

            <!-- PRIMARY: BUST SIZE / MUSCULATURE -->
            <div class="feature-group" id="group-primary">
                <div class="feature-header">
                    <span class="feature-label" id="label-primary">èƒ¸éƒ¨å¤§å° (Bust Size)</span>
                    <span class="feature-value" id="value-primary">ä¸­ç­‰è‡ªç„¶</span>
                </div>
                <div class="scale-labels" id="scale-primary">
                    <span class="fantasy-label">ğŸ”® ç„¡</span>
                    <span>å¹³å¦</span>
                    <span>åå°</span>
                    <span>ä¸­ç­‰</span>
                    <span>è±æ»¿</span>
                    <span>å·¨å¤§</span>
                    <span class="fantasy-label">ğŸ”® è¶…å·¨</span>
                </div>
                <div class="slider-wrapper">
                    <div class="fantasy-zone fantasy-zone-left"></div>
                    <div class="fantasy-zone fantasy-zone-right"></div>
                    <input type="range" id="slider-primary" class="slider-bust" min="1" max="7" value="4" step="1"
                        oninput="updateAll()">
                </div>
            </div>

            <!-- BUILD / FRAME -->
            <div class="feature-group">
                <div class="feature-header">
                    <span class="feature-label">é«”å‹ (Build)</span>
                    <span class="feature-value" id="value-build">æ¨™æº–</span>
                </div>
                <div class="scale-labels">
                    <span class="fantasy-label">ğŸ”® éª¨æ„Ÿ</span>
                    <span>çº–ç˜¦</span>
                    <span>è‹—æ¢</span>
                    <span>æ¨™æº–</span>
                    <span>è±è…´</span>
                    <span>å£¯ç¢©</span>
                    <span class="fantasy-label">ğŸ”® æ³°å¦</span>
                </div>
                <div class="slider-wrapper">
                    <div class="fantasy-zone fantasy-zone-left"></div>
                    <div class="fantasy-zone fantasy-zone-right"></div>
                    <input type="range" id="slider-build" class="slider-weight" min="1" max="7" value="4" step="1"
                        oninput="updateAll()">
                </div>
            </div>

            <!-- HEIGHT -->
            <div class="feature-group">
                <div class="feature-header">
                    <span class="feature-label">èº«é«˜æ¯”ä¾‹ (Height)</span>
                    <span class="feature-value" id="value-height">ä¸­ç­‰</span>
                </div>
                <div class="scale-labels">
                    <span class="fantasy-label">ğŸ”® èŸ»äºº</span>
                    <span>å¬Œå°</span>
                    <span>åçŸ®</span>
                    <span>ä¸­ç­‰</span>
                    <span>åé«˜</span>
                    <span>é«˜æŒ‘</span>
                    <span class="fantasy-label">ğŸ”® å·¨äºº</span>
                </div>
                <div class="slider-wrapper">
                    <div class="fantasy-zone fantasy-zone-left"></div>
                    <div class="fantasy-zone fantasy-zone-right"></div>
                    <input type="range" id="slider-height" class="slider-height" min="1" max="7" value="4" step="1"
                        oninput="updateAll()">
                </div>
            </div>

            <!-- PRESETS -->
            <div style="margin-top: 20px;">
                <div class="feature-label" style="margin-bottom: 10px;">å¿«é€Ÿé è¨­ (Quick Presets)</div>
                <div class="presets" id="preset-female">
                    <span class="preset-section-label">å¯«å¯¦ Realistic</span>
                    <button class="preset-btn" onclick="applyPreset('loli')">è˜¿è‰é«”å‹</button>
                    <button class="preset-btn" onclick="applyPreset('petite')">å¬Œå°å°‘å¥³</button>
                    <button class="preset-btn" onclick="applyPreset('slim')">è‹—æ¢çº–ç´°</button>
                    <button class="preset-btn" onclick="applyPreset('average')">æ¨™æº–å‡å‹»</button>
                    <button class="preset-btn" onclick="applyPreset('curvy')">æ›²ç·šæ€§æ„Ÿ</button>
                    <button class="preset-btn" onclick="applyPreset('voluptuous')">è±æ»¿èª˜äºº</button>
                    <button class="preset-btn" onclick="applyPreset('athletic_f')">é‹å‹•å¥ç¾</button>
                    <div class="preset-divider"></div>
                    <span class="preset-section-label">ğŸ”® å¹»æƒ³ Fantasy</span>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('fairy')">ğŸ§š ç²¾éˆä»™å­</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('oppai')">ğŸ¯ è¶…ä¹³å¹»æƒ³</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('amazon')">âš”ï¸ äºé¦¬éœå¥³æˆ°å£«</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('giantess')">ğŸ”ï¸ å·¨äººæ—å¥³æ€§</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('pixie')">âœ¨ å°ç²¾éˆ</button>
                </div>
                <div class="presets" id="preset-male" style="display: none;">
                    <span class="preset-section-label">å¯«å¯¦ Realistic</span>
                    <button class="preset-btn" onclick="applyPreset('shota')">æ­£å¤ªé«”å‹</button>
                    <button class="preset-btn" onclick="applyPreset('slim_m')">çº–ç˜¦å°‘å¹´</button>
                    <button class="preset-btn" onclick="applyPreset('average_m')">æ¨™æº–é«”å‹</button>
                    <button class="preset-btn" onclick="applyPreset('athletic_m')">é‹å‹•å‹</button>
                    <button class="preset-btn" onclick="applyPreset('muscular')">è‚Œè‚‰å£¯ç¢©</button>
                    <div class="preset-divider"></div>
                    <span class="preset-section-label">ğŸ”® å¹»æƒ³ Fantasy</span>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('elf_m')">ğŸ§ ç²¾éˆæ—</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('hulk')">ğŸ’ª æµ©å…‹é«”å‹</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('titan')">ğŸ”ï¸ æ³°å¦å·¨äºº</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('antman')">ğŸœ èŸ»äººç¸®å°</button>
                    <button class="preset-btn fantasy-preset" onclick="applyPreset('skeleton')">ğŸ’€ éª·é«æ³•å¸«</button>
                </div>
            </div>
        </div>

        <!-- Right: Output -->
        <div class="panel">
            <h2>ğŸ“ ç”Ÿæˆçµæœ</h2>

            <div class="fantasy-banner" id="fantasy-banner">
                <span class="icon">ğŸ”®</span>
                <span>å·²é€²å…¥<strong>å¹»æƒ³ç´šåˆ¥</strong>ï¼æç¤ºè©å°‡åŒ…å«è¶…ç¾å¯¦æè¿°ï¼Œæ¬Šé‡å¤§å¹…æé«˜ä»¥ç¢ºä¿ AI ç”Ÿæˆæ•ˆæœã€‚</span>
            </div>

            <div class="output-box">
                <div class="output-label">âœ… æ­£å‘æç¤ºè© (Positive Prompt)</div>
                <div class="output-text" id="out-positive"></div>
                <div class="weight-indicator">
                    <span style="color: #64748b;">æ§åˆ¶åŠ›åº¦:</span>
                    <div class="weight-bar">
                        <div class="weight-fill" id="weight-fill-pos" style="width: 30%; background: #86efac;"></div>
                    </div>
                    <span class="weight-num" id="weight-num-pos" style="color: #86efac;">1.1</span>
                </div>
            </div>

            <div class="output-box">
                <div class="output-label">âŒ è² å‘æç¤ºè© (Negative Prompt)</div>
                <div class="output-text" id="out-negative"></div>
            </div>

            <div class="output-box">
                <div class="output-label">ğŸ“‹ å®Œæ•´ YAML è¼¸å‡º</div>
                <div class="output-text" id="out-yaml" style="font-family: 'Consolas', monospace; font-size: 0.8rem;">
                </div>
            </div>

            <div class="explanation" id="explanation"></div>
        </div>
    </div>

    <script>
        let gender = 'female';

        // =========================================
        // 7-LEVEL FEMALE BUST (with fantasy ends)
        // =========================================
        const FEMALE_BUST = {
            1: {
                zh: 'ğŸ”® å®Œå…¨ç„¡èƒ¸ / Doll-flat',
                positive: ['completely flat chest', 'no breasts at all', 'doll-like torso', 'child-like flat body'],
                negative: ['breasts', 'cleavage', 'bust', 'curvy', 'voluptuous', 'busty', 'chest'],
                weight: 1.7,
                fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” å®Œå…¨ç„¡èƒ¸</strong>ï¼šå¦‚äººå¶æˆ–ç²¾éˆèˆ¬å®Œå…¨å¹³å¦çš„èƒ¸éƒ¨ã€‚éœ€è¦æ¥µé«˜æ¬Šé‡ (1.7) + å…¨é¢å£“åˆ¶è² å‘æç¤ºè©ã€‚é©åˆç²¾éˆã€ä»™å­ã€äººå¶ç­‰éäººé¡è§’è‰²ã€‚'
            },
            2: {
                zh: 'éå¸¸å¹³å¦ / Flat Chest',
                positive: ['flat chest', 'very small breasts', 'almost flat'],
                negative: ['big breasts', 'large breasts', 'cleavage', 'voluptuous', 'curvy', 'busty'],
                weight: 1.5,
                fantasy: false,
                explain: '<strong>éå¸¸å¹³å¦</strong>ï¼šé€†å‹¢è¨­å®šï¼Œéœ€è¦é«˜æ¬Šé‡ (1.5) + å¤§é‡è² å‘æç¤ºè©å£“åˆ¶ AI é è¨­åå¥½ã€‚å»ºè­°æ­é… young girl body æˆ– loli proportionsã€‚'
            },
            3: {
                zh: 'åå°çº–ç´° / Small',
                positive: ['small breasts', 'petite breasts', 'subtle curves', 'slim figure'],
                negative: ['large breasts', 'big breasts', 'voluptuous', 'curvy', 'busty', 'cleavage'],
                weight: 1.35,
                fantasy: false,
                explain: '<strong>åå°çº–ç´°</strong>ï¼šè¼ƒé€†å‹¢ï¼Œæ¬Šé‡ (1.35)ã€‚å»ºè­°æŠŠ age descriptor ä¸­çš„ mature womanly figure æ”¹ç‚º youthful slim figureã€‚'
            },
            4: {
                zh: 'ä¸­ç­‰è‡ªç„¶ / Medium',
                positive: ['medium breasts', 'natural breasts', 'modest bust'],
                negative: ['huge breasts', 'massive breasts', 'exaggerated proportions'],
                weight: 1.1,
                fantasy: false,
                explain: '<strong>ä¸­ç­‰è‡ªç„¶</strong>ï¼šæœ€æ¥è¿‘ AI é è¨­ï¼Œåªéœ€å¾®èª¿æ¬Šé‡ (1.1)ã€‚å»ºè­°å»æ‰ feminine curves æ”¹ç”¨ gentle curvesã€‚'
            },
            5: {
                zh: 'è±æ»¿ / Large',
                positive: ['large breasts', 'full breasts', 'curvy', 'voluptuous figure'],
                negative: ['small breasts', 'flat chest', 'petite breasts'],
                weight: 1.2,
                fantasy: false,
                explain: '<strong>è±æ»¿</strong>ï¼šé †å‹¢è¨­å®šï¼ŒAI å®¹æ˜“ç”Ÿæˆã€‚æ¬Šé‡ (1.2) è¶³å¤ ã€‚'
            },
            6: {
                zh: 'éå¸¸è±æ»¿ / Huge',
                positive: ['huge breasts', 'massive breasts', 'voluptuous', 'busty'],
                negative: [],
                weight: 1.4,
                fantasy: false,
                explain: '<strong>éå¸¸è±æ»¿</strong>ï¼šæ¥µç«¯è±æ»¿ã€‚å› å·²é è¶…é è¨­ï¼Œéœ€è¦è¼ƒé«˜æ¬Šé‡ (1.4) ç¢ºä¿ç©©å®šè¼¸å‡ºã€‚å¹¾ä¹ä¸éœ€è¦è² å‘æç¤ºè©ã€‚'
            },
            7: {
                zh: 'ğŸ”® è¶…ä¹³å¹»æƒ³ / Fantasy Massive',
                positive: ['impossibly huge breasts', 'gigantic breasts', 'breast bigger than head', 'absurdly large bust', 'gravity-defying breasts'],
                negative: ['small breasts', 'flat chest', 'realistic proportions', 'normal breasts'],
                weight: 1.8,
                fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” è¶…ä¹³</strong>ï¼šå®Œå…¨è„«é›¢ç¾å¯¦æ¯”ä¾‹çš„å¹»æƒ³ç´šå·¨å¤§ã€‚éœ€è¦æ¥µé«˜æ¬Šé‡ (1.8) + å£“åˆ¶ realistic proportionsã€‚åƒ…é©åˆå‹•æ¼«/å¹»æƒ³é¢¨æ ¼ã€‚'
            }
        };

        // =========================================
        // 7-LEVEL MALE MUSCULATURE (with fantasy ends)
        // =========================================
        const MALE_MUSCLE = {
            1: {
                zh: 'ğŸ”® éª·é«éª¨æ„Ÿ / Skeletal',
                positive: ['extremely thin', 'skeletal body', 'emaciated', 'visible ribs', 'gaunt frame', 'unnaturally thin'],
                negative: ['muscular', 'buff', 'brawny', 'broad shoulders', 'ripped', 'healthy', 'normal body'],
                weight: 1.7,
                fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” éª·é«éª¨æ„Ÿ</strong>ï¼šå¦‚äº¡éˆæ³•å¸«ã€éª·é«èˆ¬çš„è¶…è‡ªç„¶æ¶ˆç˜¦ã€‚æ¬Šé‡ (1.7) + å¤§é‡è² å‘æç¤ºè©ã€‚é©åˆä¸æ­»æ—ã€æ³•å¸«ç­‰è§’è‰²ã€‚'
            },
            2: {
                zh: 'çº–ç˜¦å°‘å¹´ / Slim',
                positive: ['slim body', 'slender body', 'thin frame', 'delicate build'],
                negative: ['muscular', 'buff', 'brawny', 'broad shoulders', 'ripped'],
                weight: 1.3,
                fantasy: false,
                explain: '<strong>çº–ç˜¦å°‘å¹´</strong>ï¼šé€†å‹¢è¨­å®šï¼ŒAI å‚¾å‘ç”Ÿæˆè¼ƒå£¯ç”·æ€§ã€‚é«˜æ¬Šé‡ (1.3) + è² å‘æç¤ºè©å£“åˆ¶è‚Œè‚‰ã€‚'
            },
            3: {
                zh: 'åç˜¦ç²¾ç·» / Lean',
                positive: ['lean body', 'slim athletic build', 'light muscle tone'],
                negative: ['muscular', 'buff', 'thick', 'brawny'],
                weight: 1.2,
                fantasy: false,
                explain: '<strong>åç˜¦ç²¾ç·»</strong>ï¼šä¸­åº¦é€†å‹¢ï¼Œç²¾å£¯ä½†ä¸éåº¦ã€‚æ¬Šé‡ (1.2) æ­é…æ§åˆ¶ã€‚'
            },
            4: {
                zh: 'æ¨™æº–é«”å‹ / Average',
                positive: ['average build', 'normal body', 'moderate build'],
                negative: ['extremely muscular', 'very thin', 'obese'],
                weight: 1.0,
                fantasy: false,
                explain: '<strong>æ¨™æº–é«”å‹</strong>ï¼šAI é è¨­ç¯„åœï¼Œå¹¾ä¹ä¸éœ€é¡å¤–æ¬Šé‡ã€‚'
            },
            5: {
                zh: 'é‹å‹•å£¯ç¢© / Athletic',
                positive: ['athletic body', 'muscular build', 'toned body', 'broad shoulders'],
                negative: ['thin', 'slender', 'skinny', 'delicate'],
                weight: 1.2,
                fantasy: false,
                explain: '<strong>é‹å‹•å£¯ç¢©</strong>ï¼šé †å‹¢è¨­å®šï¼ŒAI æ˜“ç”Ÿæˆã€‚æ¬Šé‡ (1.2) ç©©å®šæ§åˆ¶ã€‚'
            },
            6: {
                zh: 'æ¥µåº¦å£¯ç¢© / Massive',
                positive: ['extremely muscular', 'huge muscles', 'bodybuilder physique', 'massive frame'],
                negative: ['thin', 'slim', 'slender', 'skinny'],
                weight: 1.4,
                fantasy: false,
                explain: '<strong>æ¥µåº¦å£¯ç¢©</strong>ï¼šæ¥µç«¯è¨­å®šï¼Œéœ€é«˜æ¬Šé‡ (1.4) ç¢ºä¿æ¥µè‡´è‚Œè‚‰è¡¨ç¾ã€‚'
            },
            7: {
                zh: 'ğŸ”® æµ©å…‹å·¨ç¸ / Hulk',
                positive: ['impossibly muscular', 'hulk-like body', 'grotesquely muscular', 'muscles bigger than head', 'superhero physique', 'inhuman muscle mass'],
                negative: ['thin', 'slim', 'slender', 'skinny', 'normal body', 'realistic proportions'],
                weight: 1.8,
                fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” æµ©å…‹å·¨ç¸</strong>ï¼šè¶…è¶Šäººé¡æ¥µé™çš„è‚Œè‚‰é‡ï¼Œå¦‚æ¼«å¨æµ©å…‹ã€‚éœ€è¦æ¥µé«˜æ¬Šé‡ (1.8)ã€‚åƒ…é©åˆè¶…ç´šè‹±é›„/æ€ªç‰©è§’è‰²ã€‚'
            }
        };

        // =========================================
        // 7-LEVEL BUILD (with fantasy ends)
        // =========================================
        const BUILD = {
            1: {
                zh: 'ğŸ”® ç´™ç‰‡äºº', positive: ['paper-thin body', 'impossibly thin', '2d flat body', 'stick figure proportions'], negative: ['thick', 'chubby', 'round', 'normal body', 'realistic'], weight: 1.6, fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” ç´™ç‰‡äºº</strong>ï¼šå¦‚å‹•æ¼«ä¸­æ¥µç«¯çº–ç´°çš„éç¾å¯¦é«”å‹ï¼Œæˆ–ç²¾éˆæ—çš„è¶…è‡ªç„¶çº–ç´°ã€‚'
            },
            2: {
                zh: 'çº–ç˜¦', positive: ['skinny body', 'very thin'], negative: ['thick', 'chubby', 'round'], weight: 1.2, fantasy: false,
                explain: '<strong>çº–ç˜¦</strong>ï¼šæ˜é¡¯åç˜¦ï¼Œæ¬Šé‡ (1.2) + å£“åˆ¶è² å‘ã€‚'
            },
            3: {
                zh: 'è‹—æ¢', positive: ['slim body', 'slender'], negative: ['thick', 'chubby'], weight: 1.1, fantasy: false,
                explain: '<strong>è‹—æ¢</strong>ï¼šå¥åº·çš„çº–ç´°ï¼Œå¾®èª¿å³å¯ã€‚'
            },
            4: {
                zh: 'æ¨™æº–', positive: ['average body'], negative: [], weight: 1.0, fantasy: false,
                explain: '<strong>æ¨™æº–</strong>ï¼šAI é è¨­ç¯„åœã€‚'
            },
            5: {
                zh: 'è±è…´', positive: ['plump body', 'soft figure'], negative: ['skinny', 'thin'], weight: 1.2, fantasy: false,
                explain: '<strong>è±è…´</strong>ï¼šç•¥å¸¶è±æ»¿æ„Ÿï¼Œæ¬Šé‡ (1.2)ã€‚'
            },
            6: {
                zh: 'å£¯ç¢©', positive: ['thick body', 'large frame'], negative: ['thin', 'slim', 'slender'], weight: 1.3, fantasy: false,
                explain: '<strong>å£¯ç¢©</strong>ï¼šåšå¯¦é«”å‹ï¼Œéœ€è¦è¼ƒé«˜æ§åˆ¶ã€‚'
            },
            7: {
                zh: 'ğŸ”® æ³°å¦', positive: ['titan-sized body', 'colossal frame', 'impossibly massive build', 'mountain-like physique'], negative: ['thin', 'slim', 'normal', 'human-sized', 'realistic'], weight: 1.7, fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” æ³°å¦</strong>ï¼šå¦‚é€²æ“Šçš„å·¨äººèˆ¬çš„è¶…è‡ªç„¶é¾å¤§é«”å‹ã€‚å®Œå…¨è„«é›¢äººé¡æ¯”ä¾‹ã€‚'
            }
        };

        // =========================================
        // 7-LEVEL HEIGHT (with fantasy ends)
        // =========================================
        const HEIGHT = {
            1: {
                zh: 'ğŸ”® èŸ»äºº/å°ç²¾éˆ', positive: ['miniature body', 'fairy-sized', 'tiny creature', 'palm-sized', 'chibi proportions', 'ant-sized'], negative: ['tall', 'long legs', 'normal height', 'human-sized'], weight: 1.8, fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” èŸ»äºº/å°ç²¾éˆ</strong>ï¼šå¦‚æ‰‹æŒå¤§å°çš„ç²¾éˆã€ä»™å­æˆ–èŸ»äººç¸®å°ç‹€æ…‹ã€‚éœ€è¦æ¥µé«˜æ¬Šé‡ (1.8)ã€‚'
            },
            2: {
                zh: 'å¬Œå°', positive: ['petite body', 'small frame', 'short stature'], negative: ['tall', 'long legs'], weight: 1.3, fantasy: false,
                explain: '<strong>å¬Œå°</strong>ï¼šæ˜é¡¯çŸ®å°æˆ–åƒå°å­©çš„èº«é«˜ã€‚'
            },
            3: {
                zh: 'åçŸ®', positive: ['short body', 'compact build'], negative: ['tall'], weight: 1.15, fantasy: false,
                explain: '<strong>åçŸ®</strong>ï¼šç•¥çŸ®ï¼Œå¾®èª¿ã€‚'
            },
            4: {
                zh: 'ä¸­ç­‰', positive: [], negative: [], weight: 1.0, fantasy: false,
                explain: '<strong>ä¸­ç­‰</strong>ï¼šæ­£å¸¸èº«é«˜ï¼Œä¸éœ€è¦é¡å¤–æ§åˆ¶ã€‚'
            },
            5: {
                zh: 'åé«˜', positive: ['tall body', 'long legs'], negative: ['short', 'petite'], weight: 1.15, fantasy: false,
                explain: '<strong>åé«˜</strong>ï¼šç•¥é«˜ï¼Œå¾®èª¿ã€‚'
            },
            6: {
                zh: 'é«˜æŒ‘', positive: ['very tall', 'long legs', 'elongated proportions'], negative: ['short', 'petite', 'small'], weight: 1.3, fantasy: false,
                explain: '<strong>é«˜æŒ‘</strong>ï¼šæ˜é¡¯é«˜æŒ‘ã€‚'
            },
            7: {
                zh: 'ğŸ”® å·¨äººæ—', positive: ['giant', 'towering over buildings', 'colossal height', '3 meters tall', 'gigantic humanoid', 'looking down at tiny people'], negative: ['short', 'petite', 'small', 'normal height', 'human-sized'], weight: 1.8, fantasy: true,
                explain: 'ğŸ”® <strong>å¹»æƒ³ç´š â€” å·¨äººæ—</strong>ï¼šå¦‚é€²æ“Šçš„å·¨äººèˆ¬çš„è¶…è‡ªç„¶èº«é«˜ï¼ˆ3å…¬å°ºä»¥ä¸Šï¼‰ã€‚éœ€è¦æ¥µé«˜æ¬Šé‡ (1.8) + ç‰¹æ®Šæ§‹åœ–æç¤ºã€‚'
            }
        };

        // =========================================
        // PRESETS (including fantasy)
        // =========================================
        const PRESETS = {
            // Female Realistic
            'loli': { primary: 2, build: 2, height: 2 },
            'petite': { primary: 3, build: 3, height: 2 },
            'slim': { primary: 3, build: 3, height: 4 },
            'average': { primary: 4, build: 4, height: 4 },
            'curvy': { primary: 5, build: 4, height: 4 },
            'voluptuous': { primary: 6, build: 5, height: 4 },
            'athletic_f': { primary: 4, build: 4, height: 5 },
            // Female Fantasy
            'fairy': { primary: 1, build: 1, height: 1 },
            'oppai': { primary: 7, build: 4, height: 4 },
            'amazon': { primary: 5, build: 6, height: 6 },
            'giantess': { primary: 5, build: 6, height: 7 },
            'pixie': { primary: 1, build: 1, height: 1 },
            // Male Realistic
            'shota': { primary: 2, build: 2, height: 2 },
            'slim_m': { primary: 3, build: 3, height: 4 },
            'average_m': { primary: 4, build: 4, height: 4 },
            'athletic_m': { primary: 5, build: 4, height: 5 },
            'muscular': { primary: 6, build: 5, height: 5 },
            // Male Fantasy
            'elf_m': { primary: 2, build: 2, height: 5 },
            'hulk': { primary: 7, build: 7, height: 6 },
            'titan': { primary: 7, build: 7, height: 7 },
            'antman': { primary: 4, build: 4, height: 1 },
            'skeleton': { primary: 1, build: 1, height: 4 }
        };

        function setGender(g) {
            gender = g;
            document.querySelectorAll('.gender-btn').forEach((btn, i) => {
                btn.classList.toggle('active', (i === 0 && g === 'female') || (i === 1 && g === 'male'));
            });

            const labelPrimary = document.getElementById('label-primary');
            const scalePrimary = document.getElementById('scale-primary');
            const slider = document.getElementById('slider-primary');

            if (g === 'female') {
                labelPrimary.textContent = 'èƒ¸éƒ¨å¤§å° (Bust Size)';
                scalePrimary.innerHTML = '<span class="fantasy-label">ğŸ”® ç„¡</span><span>å¹³å¦</span><span>åå°</span><span>ä¸­ç­‰</span><span>è±æ»¿</span><span>å·¨å¤§</span><span class="fantasy-label">ğŸ”® è¶…å·¨</span>';
                slider.className = 'slider-bust';
                document.getElementById('preset-female').style.display = 'flex';
                document.getElementById('preset-male').style.display = 'none';
            } else {
                labelPrimary.textContent = 'è‚Œè‚‰é‡ (Musculature)';
                scalePrimary.innerHTML = '<span class="fantasy-label">ğŸ”® éª·é«</span><span>çº–ç˜¦</span><span>åç˜¦</span><span>æ¨™æº–</span><span>å£¯ç¢©</span><span>æ¥µå£¯</span><span class="fantasy-label">ğŸ”® æµ©å…‹</span>';
                slider.className = 'slider-muscle';
                document.getElementById('preset-female').style.display = 'none';
                document.getElementById('preset-male').style.display = 'flex';
            }
            updateAll();
        }

        function applyPreset(name) {
            const p = PRESETS[name];
            if (!p) return;
            document.getElementById('slider-primary').value = p.primary;
            document.getElementById('slider-build').value = p.build;
            document.getElementById('slider-height').value = p.height;
            updateAll();
        }

        function formatWeighted(tags, weight, isFantasy) {
            if (tags.length === 0) return '';
            if (weight <= 1.0) return tags.join(', ');
            const cls = isFantasy ? 'fantasy-tag' : 'weight';
            return tags.map(t => `<span class="${cls}">(${t}:${weight.toFixed(1)})</span>`).join(', ');
        }

        function updateAll() {
            const pVal = parseInt(document.getElementById('slider-primary').value);
            const bVal = parseInt(document.getElementById('slider-build').value);
            const hVal = parseInt(document.getElementById('slider-height').value);

            const primary = gender === 'female' ? FEMALE_BUST[pVal] : MALE_MUSCLE[pVal];
            const build = BUILD[bVal];
            const height = HEIGHT[hVal];

            // Check if any slider is in fantasy zone
            const hasFantasy = primary.fantasy || build.fantasy || height.fantasy;

            // Update fantasy banner
            document.getElementById('fantasy-banner').classList.toggle('show', hasFantasy);

            // Update value labels with fantasy class
            const valPrimary = document.getElementById('value-primary');
            const valBuild = document.getElementById('value-build');
            const valHeight = document.getElementById('value-height');
            valPrimary.textContent = primary.zh;
            valBuild.textContent = build.zh;
            valHeight.textContent = height.zh;
            valPrimary.classList.toggle('fantasy', primary.fantasy);
            valBuild.classList.toggle('fantasy', build.fantasy);
            valHeight.classList.toggle('fantasy', height.fantasy);

            // Update slider fantasy class
            document.getElementById('slider-primary').classList.toggle('in-fantasy', primary.fantasy);
            document.getElementById('slider-build').classList.toggle('in-fantasy', build.fantasy);
            document.getElementById('slider-height').classList.toggle('in-fantasy', height.fantasy);

            // Compute combined positive
            let allPositive = [];
            let allNegative = [];

            if (primary.positive.length) allPositive.push(formatWeighted(primary.positive, primary.weight, primary.fantasy));
            if (build.positive.length) allPositive.push(formatWeighted(build.positive, build.weight, build.fantasy));
            if (height.positive.length) allPositive.push(formatWeighted(height.positive, height.weight, height.fantasy));

            allNegative = [...primary.negative, ...build.negative, ...height.negative];
            allNegative = [...new Set(allNegative)]; // deduplicate

            // Positive output
            const posDiv = document.getElementById('out-positive');
            posDiv.innerHTML = allPositive.filter(Boolean).join(', ') || '<span style="color: #64748b;">ï¼ˆæ¨™æº–è¨­å®šï¼Œç„¡é¡å¤–æ­£å‘æç¤ºè©ï¼‰</span>';

            // Negative output
            const negDiv = document.getElementById('out-negative');
            negDiv.innerHTML = allNegative.length
                ? allNegative.map(t => `<span class="negative">${t}</span>`).join(', ')
                : '<span style="color: #64748b;">ï¼ˆç„¡éœ€è² å‘æç¤ºè©ï¼‰</span>';

            // YAML output
            const yamlDiv = document.getElementById('out-yaml');
            let yaml = '';
            if (primary.positive.length) {
                const pKey = gender === 'female' ? 'bust' : 'musculature';
                const prefix = primary.fantasy ? 'ğŸ”® ' : '';
                yaml += `<span class="tag">${pKey}:</span> ${prefix}${primary.positive.map(t => primary.weight > 1 ? `(${t}:${primary.weight.toFixed(1)})` : t).join(', ')}\n`;
            }
            if (build.positive.length) {
                const prefix = build.fantasy ? 'ğŸ”® ' : '';
                yaml += `<span class="tag">build:</span> ${prefix}${build.positive.map(t => build.weight > 1 ? `(${t}:${build.weight.toFixed(1)})` : t).join(', ')}\n`;
            }
            if (height.positive.length) {
                const prefix = height.fantasy ? 'ğŸ”® ' : '';
                yaml += `<span class="tag">height:</span> ${prefix}${height.positive.map(t => height.weight > 1 ? `(${t}:${height.weight.toFixed(1)})` : t).join(', ')}\n`;
            }
            if (allNegative.length) {
                yaml += `<span class="negative">negative:</span> ${allNegative.join(', ')}`;
            }
            yamlDiv.innerHTML = yaml || '<span style="color: #64748b;">body: average body</span>';

            // Weight indicator
            const maxWeight = Math.max(primary.weight, build.weight, height.weight);
            const fillPct = Math.min(((maxWeight - 1.0) / 0.8) * 100, 100);
            const fillEl = document.getElementById('weight-fill-pos');
            const numEl = document.getElementById('weight-num-pos');
            fillEl.style.width = fillPct + '%';
            numEl.textContent = maxWeight.toFixed(1);

            if (maxWeight >= 1.6) {
                fillEl.style.background = 'linear-gradient(to right, #fbbf24, #ef4444, #dc2626)';
                numEl.style.color = '#fbbf24';
            } else if (maxWeight >= 1.3) {
                fillEl.style.background = 'linear-gradient(to right, #fbbf24, #ef4444)';
                numEl.style.color = '#fca5a5';
            } else if (maxWeight >= 1.15) {
                fillEl.style.background = 'linear-gradient(to right, #86efac, #fbbf24)';
                numEl.style.color = '#fcd34d';
            } else {
                fillEl.style.background = '#86efac';
                numEl.style.color = '#86efac';
            }

            // Explanation: combine all slider explanations
            let explainHTML = '';
            explainHTML += `<strong>ğŸ’¡ åŸç†èªªæ˜ï¼š</strong><br>`;
            explainHTML += `<br>â–¸ <strong>${gender === 'female' ? 'èƒ¸éƒ¨' : 'è‚Œè‚‰'}</strong>ï¼š${primary.explain}`;
            explainHTML += `<br><br>â–¸ <strong>é«”å‹</strong>ï¼š${build.explain}`;
            explainHTML += `<br><br>â–¸ <strong>èº«é«˜</strong>ï¼š${height.explain}`;
            document.getElementById('explanation').innerHTML = explainHTML;
        }

        // Init
        updateAll();
    </script>

</body>

</html>